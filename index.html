   <!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoteSpace - 익명 커뮤니티</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap');
        
        body { 
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: #f8f9fa;
        }
        
        .header-gradient {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
        }
        
        .nav-item {
            transition: all 0.2s ease;
        }
        
        .nav-item:hover {
            background: rgba(37, 99, 235, 0.1);
        }
        
        .nav-item.active {
            background: #2563eb;
            color: white;
        }
        
        .card {
            background: white;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .post-row {
            transition: background-color 0.15s ease;
        }
        
        .post-row:hover {
            background: #f9fafb;
        }
        
        .gallery-item {
            transition: all 0.2s ease;
        }
        
        .gallery-item:hover {
            background: #f3f4f6;
            transform: translateY(-1px);
        }
        
        .vote-option {
            transition: all 0.2s ease;
            border: 2px solid #e5e7eb;
        }
        
        .vote-option:hover:not(:disabled) {
            border-color: #2563eb;
            background: #eff6ff;
        }
        
        .vote-option:disabled {
            opacity: 0.7;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #2563eb 0%, #1d4ed8 100%);
        }
        
        .btn-primary {
            background: #2563eb;
            color: white;
            transition: all 0.2s ease;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
            transition: all 0.2s ease;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .search-filter.active {
            background: #2563eb;
            color: white;
        }
        
        .tag {
            background: #eff6ff;
            color: #2563eb;
            border: 1px solid #bfdbfe;
        }
    </style>
</head>
<body>
    <div class="min-h-screen">
        <!-- 헤더 -->
        <header class="header-gradient shadow-sm">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center gap-3">
                        <h1 class="text-2xl font-bold text-white">VoteSpace</h1>
                        <span class="text-blue-100 text-sm">익명 커뮤니티</span>
                    </div>
                    <div class="text-blue-100 text-sm">
                        실시간 투표 & 토론
                    </div>
                </div>
            </div>
        </header>

        <!-- 네비게이션 -->
        <nav class="bg-white border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex space-x-1">
                    <button onclick="showSection('home')" id="homeBtn" class="nav-item px-4 py-3 text-sm font-medium rounded-none active">
                        홈
                    </button>
                    <button onclick="showSection('galleries')" id="galleriesBtn" class="nav-item px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-900">
                        갤러리
                    </button>
                    <button onclick="showSection('popular-posts')" id="popularPostsBtn" class="nav-item px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-900">
                        베스트
                    </button>
                    <button onclick="showSection('search')" id="searchBtn" class="nav-item px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-900">
                        검색
                    </button>
                    <button onclick="showSection('votes')" id="votesBtn" class="nav-item px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-900">
                        투표
                    </button>
                </div>
            </div>
        </nav>

        <!-- 커스텀 배너 영역 -->
        <div id="customBanner" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white">
            <div class="max-w-7xl mx-auto px-4 py-8">
                <div class="text-center">
                    <h2 class="text-3xl font-bold mb-2">🎉 VoteSpace에 오신 것을 환영합니다!</h2>
                    <p class="text-lg opacity-90 mb-4">자유롭게 의견을 나누고 투표에 참여해보세요</p>
                    <div class="flex justify-center gap-4">
                        <button onclick="showSection('votes')" class="bg-white text-purple-600 px-6 py-2 rounded-full font-medium hover:bg-gray-100 transition-colors">
                            🗳️ 투표 참여하기
                        </button>
                        <button onclick="showSection('galleries')" class="bg-purple-500 bg-opacity-50 px-6 py-2 rounded-full font-medium hover:bg-opacity-70 transition-colors">
                            📝 글 작성하기
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-4 py-6">
            <!-- 홈 섹션 -->
            <div id="homeSection" class="section">
                <div class="grid lg:grid-cols-3 gap-6">
                    <!-- 메인 컨텐츠 -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- 베스트 글 -->
                        <div class="card rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="flex items-center justify-between">
                                    <h2 class="text-lg font-semibold text-gray-900">🔥 실시간 베스트</h2>
                                    <button onclick="showSection('popular-posts')" class="text-sm text-blue-600 hover:text-blue-800">
                                        더보기
                                    </button>
                                </div>
                            </div>
                            <div id="homeBestPosts" class="divide-y divide-gray-100">
                                <!-- 베스트 글 목록 -->
                            </div>
                        </div>

                        <!-- 최신 글 -->
                        <div class="card rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <h2 class="text-lg font-semibold text-gray-900">📝 최신 글</h2>
                            </div>
                            <div id="homePosts" class="divide-y divide-gray-100">
                                <!-- 최신 글 목록 -->
                            </div>
                        </div>
                    </div>

                    <!-- 사이드바 -->
                    <div class="space-y-6">
                        <!-- 갤러리 목록 -->
                        <div class="card rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="flex items-center justify-between">
                                    <h3 class="font-semibold text-gray-900">갤러리</h3>
                                    <button onclick="showSection('galleries')" class="text-sm text-blue-600 hover:text-blue-800">
                                        전체
                                    </button>
                                </div>
                            </div>
                            <div id="homeGalleries" class="p-4 space-y-2">
                                <!-- 갤러리 목록 -->
                            </div>
                        </div>

                        <!-- 실시간 투표 -->
                        <div class="card rounded-lg">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="flex items-center justify-between">
                                    <h3 class="font-semibold text-gray-900">실시간 투표</h3>
                                    <button onclick="showSection('votes')" class="text-sm text-blue-600 hover:text-blue-800">
                                        더보기
                                    </button>
                                </div>
                            </div>
                            <div id="homePolls" class="p-4 space-y-3">
                                <!-- 투표 목록 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 갤러리 섹션 -->
            <div id="galleriesSection" class="section hidden">
                <div class="card rounded-lg">
                    <div class="px-6 py-4 border-b border-gray-200">
                        <h2 class="text-xl font-bold text-gray-900">갤러리 목록</h2>
                    </div>
                    <div id="galleriesList" class="p-6">
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- 갤러리 목록 -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- 베스트 글 섹션 -->
            <div id="popularPostsSection" class="section hidden">
                <div class="card rounded-lg">
                    <div class="px-6 py-4 border-b border-gray-200">
                        <h2 class="text-xl font-bold text-gray-900">베스트 글 TOP 20</h2>
                    </div>
                    <div id="popularPostsList" class="divide-y divide-gray-100">
                        <!-- 베스트 글 목록 -->
                    </div>
                </div>
            </div>

            <!-- 검색 섹션 -->
            <div id="searchSection" class="section hidden">
                <div class="card rounded-lg">
                    <div class="px-6 py-4 border-b border-gray-200">
                        <h2 class="text-xl font-bold text-gray-900">통합 검색</h2>
                    </div>
                    <div class="p-6">
                        <!-- 검색 입력 -->
                        <div class="mb-6">
                            <div class="flex gap-3">
                                <input type="text" id="searchInput" placeholder="검색어를 입력하세요" class="flex-1 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" onkeypress="if(event.key==='Enter') performSearch()">
                                <button onclick="performSearch()" class="btn-primary px-6 py-2 rounded-md font-medium">
                                    검색
                                </button>
                            </div>
                        </div>

                        <!-- 검색 필터 -->
                        <div class="mb-6 flex gap-2">
                            <button onclick="setSearchFilter('all')" id="filterAll" class="search-filter px-4 py-2 text-sm rounded-md border active">
                                전체
                            </button>
                            <button onclick="setSearchFilter('posts')" id="filterPosts" class="search-filter px-4 py-2 text-sm rounded-md border text-gray-600 hover:bg-gray-50">
                                글만
                            </button>
                            <button onclick="setSearchFilter('polls')" id="filterPolls" class="search-filter px-4 py-2 text-sm rounded-md border text-gray-600 hover:bg-gray-50">
                                투표만
                            </button>
                        </div>

                        <!-- 검색 결과 -->
                        <div id="searchResults">
                            <div class="text-center py-12 text-gray-500">
                                <div class="text-4xl mb-4">🔍</div>
                                <p>검색어를 입력하여 글과 투표를 찾아보세요</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 투표 섹션 -->
            <div id="votesSection" class="section hidden">
                <!-- 투표 생성 버튼 -->
                <div class="mb-6">
                    <button onclick="toggleCreateForm()" class="btn-primary px-6 py-3 rounded-md font-medium">
                        + 새 투표 만들기
                    </button>
                </div>

                <!-- 투표 생성 폼 -->
                <div id="createForm" class="hidden mb-6">
                    <div class="card rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">새 투표 생성</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">투표 제목</label>
                                <input type="text" id="pollTitle" placeholder="투표 제목을 입력하세요" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">선택지 1</label>
                                    <input type="text" id="option1" placeholder="첫 번째 선택지" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">선택지 2</label>
                                    <input type="text" id="option2" placeholder="두 번째 선택지" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            <div class="flex gap-3">
                                <button onclick="createPoll()" class="btn-primary px-6 py-2 rounded-md font-medium">
                                    생성
                                </button>
                                <button onclick="toggleCreateForm()" class="btn-secondary px-6 py-2 rounded-md font-medium">
                                    취소
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="pollsList" class="space-y-6">
                    <!-- 투표 목록 -->
                </div>
            </div>

            <!-- 갤러리 상세 섹션 -->
            <div id="galleryDetailSection" class="section hidden">
                <div class="mb-4">
                    <button onclick="showSection('galleries')" class="btn-secondary px-4 py-2 rounded-md text-sm">
                        ← 갤러리 목록
                    </button>
                </div>
                
                <div class="card rounded-lg">
                    <div class="px-6 py-4 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 id="galleryTitle" class="text-xl font-bold text-gray-900"></h2>
                                <p id="galleryDescription" class="text-sm text-gray-600 mt-1"></p>
                            </div>
                            <button onclick="toggleWriteForm()" class="btn-primary px-4 py-2 rounded-md text-sm">
                                글쓰기
                            </button>
                        </div>
                    </div>

                    <!-- 글쓰기 폼 -->
                    <div id="writeForm" class="hidden border-b border-gray-200 p-6 bg-gray-50">
                        <h3 class="font-semibold mb-4">새 글 작성</h3>
                        <div class="space-y-4">
                            <input type="text" id="postTitle" placeholder="제목" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <textarea id="postContent" placeholder="내용을 입력하세요" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"></textarea>
                            <div class="flex gap-3">
                                <button onclick="createPost()" class="btn-primary px-6 py-2 rounded-md font-medium">
                                    작성
                                </button>
                                <button onclick="toggleWriteForm()" class="btn-secondary px-6 py-2 rounded-md font-medium">
                                    취소
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="galleryPosts" class="divide-y divide-gray-100">
                        <!-- 갤러리 글 목록 -->
                    </div>
                </div>
            </div>

            <!-- 글 상세 섹션 -->
            <div id="postDetailSection" class="section hidden">
                <div class="mb-4">
                    <button onclick="goBackToGallery()" class="btn-secondary px-4 py-2 rounded-md text-sm">
                        ← 갤러리로 돌아가기
                    </button>
                </div>
                
                <div class="card rounded-lg p-6">
                    <div id="postDetail">
                        <!-- 글 상세 내용 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 데이터 저장소
        let galleries = [
            { id: 1, name: "음식 갤러리", description: "맛있는 음식에 대한 모든 이야기", icon: "🍕", posts: 0, todayPosts: 0 },
            { id: 2, name: "게임 갤러리", description: "게임 리뷰, 공략, 토론", icon: "🎮", posts: 0, todayPosts: 0 },
            { id: 3, name: "영화 갤러리", description: "영화 리뷰와 추천", icon: "🎬", posts: 0, todayPosts: 0 },
            { id: 4, name: "스포츠 갤러리", description: "스포츠 소식과 토론", icon: "⚽", posts: 0, todayPosts: 0 },
            { id: 5, name: "음악 갤러리", description: "음악 추천과 리뷰", icon: "🎵", posts: 0, todayPosts: 0 },
            { id: 6, name: "여행 갤러리", description: "여행 후기와 정보", icon: "✈️", posts: 0, todayPosts: 0 },
            { id: 7, name: "패션 갤러리", description: "패션과 뷰티 정보", icon: "👗", posts: 0, todayPosts: 0 },
            { id: 8, name: "IT 갤러리", description: "기술과 IT 소식", icon: "💻", posts: 0, todayPosts: 0 }
        ];

        let posts = [
            { id: 1, galleryId: 1, title: "짜장면 vs 짬뽕 어떤게 더 맛있을까요?", content: "오늘 점심 메뉴로 고민중인데 여러분 의견이 궁금해요!", author: "익명의 미식가", timestamp: Date.now() - 1800000, likes: 15, dislikes: 2, comments: [] },
            { id: 2, galleryId: 2, title: "요즘 핫한 게임 추천해주세요", content: "새로운 게임을 찾고 있는데 재미있는 게임 있나요?", author: "게임러버", timestamp: Date.now() - 3600000, likes: 23, dislikes: 1, comments: [] },
            { id: 3, galleryId: 3, title: "이번 주말에 볼만한 영화", content: "극장에서 볼만한 영화 추천 부탁드려요!", author: "영화광", timestamp: Date.now() - 7200000, likes: 18, dislikes: 0, comments: [] },
            { id: 4, galleryId: 1, title: "집에서 만들기 쉬운 요리", content: "요리 초보도 쉽게 만들 수 있는 레시피 공유해요", author: "요리초보", timestamp: Date.now() - 10800000, likes: 31, dislikes: 3, comments: [] }
        ];

        let polls = [
            {
                id: 1, title: "짜장면 vs 짬뽕", options: ["짜장면", "짬뽕"], votes: [45, 38],
                tags: ["음식", "중식"], timestamp: Date.now() - 3600000, comments: []
            },
            {
                id: 2, title: "치킨 vs 피자", options: ["치킨", "피자"], votes: [62, 41],
                tags: ["음식", "배달"], timestamp: Date.now() - 7200000, comments: []
            }
        ];

        let currentSection = 'home';
        let currentGallery = null;
        let currentPost = null;
        let votedPolls = new Set();
        let likedPosts = new Set();
        let dislikedPosts = new Set();
        let postIdCounter = 5;
        let commentIdCounter = 1;
        let searchFilter = 'all';

        // 갤러리별 글 개수 업데이트
        function updateGalleryStats() {
            galleries.forEach(gallery => {
                gallery.posts = posts.filter(post => post.galleryId === gallery.id).length;
                gallery.todayPosts = posts.filter(post => 
                    post.galleryId === gallery.id && 
                    Date.now() - post.timestamp < 86400000
                ).length;
            });
        }

        // 페이지 로드 시 초기화
        window.onload = function() {
            updateGalleryStats();
            showSection('home');
        };

        // 섹션 전환
        function showSection(section) {
            // 모든 섹션 숨기기
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            
            // 네비게이션 버튼 스타일 초기화
            document.querySelectorAll('.nav-item').forEach(btn => {
                btn.className = 'nav-item px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-900';
            });

            // 선택된 섹션 표시
            document.getElementById(section + 'Section').classList.remove('hidden');
            document.getElementById(section + 'Btn').className = 'nav-item px-4 py-3 text-sm font-medium rounded-none active';
            
            currentSection = section;

            // 섹션별 데이터 로드
            switch(section) {
                case 'home':
                    displayHome();
                    break;
                case 'galleries':
                    displayGalleries();
                    break;
                case 'popular-posts':
                    displayPopularPosts();
                    break;
                case 'search':
                    displaySearch();
                    break;
                case 'votes':
                    displayPolls();
                    break;
            }
        }

        // 홈 화면 표시
        function displayHome() {
            // 사이드바 갤러리 목록
            const popularGalleries = [...galleries]
                .sort((a, b) => b.posts - a.posts)
                .slice(0, 8);
            
            document.getElementById('homeGalleries').innerHTML = popularGalleries.map(gallery => `
                <div class="gallery-item flex items-center justify-between p-2 rounded cursor-pointer" onclick="showGalleryDetail(${gallery.id})">
                    <div class="flex items-center gap-2">
                        <span class="text-sm">${gallery.icon}</span>
                        <span class="text-sm font-medium text-gray-800">${gallery.name}</span>
                    </div>
                    <div class="text-xs text-gray-500">
                        ${gallery.posts}
                        ${gallery.todayPosts > 0 ? `<span class="text-red-500">+${gallery.todayPosts}</span>` : ''}
                    </div>
                </div>
            `).join('');

            // 베스트 글
            const bestPosts = [...posts]
                .sort((a, b) => (b.likes - b.dislikes) - (a.likes - a.dislikes))
                .slice(0, 5);
            
            document.getElementById('homeBestPosts').innerHTML = bestPosts.map(post => {
                const gallery = galleries.find(g => g.id === post.galleryId);
                return `
                    <div class="post-row flex items-center justify-between px-6 py-4 cursor-pointer" onclick="showPostDetail(${post.id})">
                        <div class="flex items-center gap-3 flex-1">
                            <span class="text-sm">${gallery.icon}</span>
                            <div class="flex-1">
                                <div class="font-medium text-gray-900 truncate">${post.title}</div>
                                <div class="text-sm text-gray-500">${gallery.name} • ${post.author}</div>
                            </div>
                        </div>
                        <div class="text-right text-sm">
                            <div class="text-red-500 font-medium">👍 ${post.likes}</div>
                            <div class="text-gray-400">${getTimeAgo(post.timestamp)}</div>
                        </div>
                    </div>
                `;
            }).join('');

            // 사이드바 투표 목록
            const recentPolls = polls.slice(0, 3);
            document.getElementById('homePolls').innerHTML = recentPolls.map(poll => {
                const totalVotes = poll.votes.reduce((a, b) => a + b, 0);
                return `
                    <div class="p-3 bg-gray-50 rounded cursor-pointer hover:bg-gray-100 transition-colors" onclick="showSection('votes')">
                        <div class="font-medium text-gray-800 text-sm mb-1 truncate">${poll.title}</div>
                        <div class="text-xs text-gray-500">${totalVotes}표 • ${getTimeAgo(poll.timestamp)}</div>
                    </div>
                `;
            }).join('');

            // 최신 글
            const recentPosts = [...posts]
                .sort((a, b) => b.timestamp - a.timestamp)
                .slice(0, 10);
            
            document.getElementById('homePosts').innerHTML = recentPosts.map(post => {
                const gallery = galleries.find(g => g.id === post.galleryId);
                return `
                    <div class="post-row flex items-center justify-between px-6 py-4 cursor-pointer" onclick="showPostDetail(${post.id})">
                        <div class="flex items-center gap-3 flex-1">
                            <span class="text-sm">${gallery.icon}</span>
                            <div class="flex-1">
                                <div class="font-medium text-gray-900 truncate">${post.title}</div>
                                <div class="text-sm text-gray-500">${gallery.name} • ${post.author}</div>
                            </div>
                        </div>
                        <div class="text-right text-sm">
                            <div class="text-gray-600">👍 ${post.likes}</div>
                            <div class="text-gray-400">${getTimeAgo(post.timestamp)}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // 갤러리 목록 표시
        function displayGalleries() {
            updateGalleryStats();
            document.getElementById('galleriesList').innerHTML = galleries.map(gallery => `
                <div class="gallery-item border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-sm" onclick="showGalleryDetail(${gallery.id})">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="text-2xl">${gallery.icon}</span>
                        <div>
                            <h3 class="font-semibold text-gray-900">${gallery.name}</h3>
                            <p class="text-sm text-gray-600">${gallery.description}</p>
                        </div>
                    </div>
                    <div class="flex justify-between text-sm text-gray-500">
                        <span>총 ${gallery.posts}개</span>
                        <span class="text-blue-600">오늘 ${gallery.todayPosts}개</span>
                    </div>
                </div>
            `).join('');
        }

        // 인기 글 표시
        function displayPopularPosts() {
            const popularPosts = [...posts]
                .sort((a, b) => (b.likes - b.dislikes) - (a.likes - a.dislikes))
                .slice(0, 20);

            document.getElementById('popularPostsList').innerHTML = popularPosts.map((post, index) => {
                const gallery = galleries.find(g => g.id === post.galleryId);
                return `
                    <div class="post-row flex items-center gap-4 px-6 py-4 cursor-pointer" onclick="showPostDetail(${post.id})">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white text-sm font-bold">
                            ${index + 1}
                        </div>
                        <span class="text-lg">${gallery.icon}</span>
                        <div class="flex-1">
                            <h4 class="font-medium text-gray-900">${post.title}</h4>
                            <div class="flex items-center gap-4 text-sm text-gray-500">
                                <span>${gallery.name}</span>
                                <span>${post.author}</span>
                                <span>${getTimeAgo(post.timestamp)}</span>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-blue-600">👍 ${post.likes}</div>
                            <div class="text-sm text-gray-500">👎 ${post.dislikes}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // 갤러리 상세 표시
        function showGalleryDetail(galleryId) {
            currentGallery = galleries.find(g => g.id === galleryId);
            if (!currentGallery) return;

            document.getElementById('galleryTitle').textContent = currentGallery.name;
            document.getElementById('galleryDescription').textContent = currentGallery.description;

            const galleryPosts = posts.filter(post => post.galleryId === galleryId)
                .sort((a, b) => b.timestamp - a.timestamp);

            document.getElementById('galleryPosts').innerHTML = galleryPosts.length > 0 ? galleryPosts.map(post => `
                <div class="post-row flex items-center justify-between px-6 py-4 cursor-pointer" onclick="showPostDetail(${post.id})">
                    <div class="flex-1">
                        <h4 class="font-medium text-gray-900 mb-1">${post.title}</h4>
                        <div class="flex items-center gap-4 text-sm text-gray-500">
                            <span>${post.author}</span>
                            <span>${getTimeAgo(post.timestamp)}</span>
                            <span>💬 ${post.comments.length}</span>
                        </div>
                    </div>
                    <div class="text-right text-sm">
                        <div class="text-blue-600 font-medium">👍 ${post.likes}</div>
                        <div class="text-gray-500">👎 ${post.dislikes}</div>
                    </div>
                </div>
            `).join('') : '<div class="text-center py-12 text-gray-500">아직 작성된 글이 없습니다.<br>첫 번째 글을 작성해보세요!</div>';

            // 모든 섹션 숨기고 갤러리 상세 표시
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById('galleryDetailSection').classList.remove('hidden');
        }

        // 글 상세 표시
        function showPostDetail(postId) {
            currentPost = posts.find(p => p.id === postId);
            if (!currentPost) return;

            const gallery = galleries.find(g => g.id === currentPost.galleryId);
            
            document.getElementById('postDetail').innerHTML = `
                <div class="mb-6">
                    <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
                        <span>${gallery.icon} ${gallery.name}</span>
                        <span>•</span>
                        <span>${getTimeAgo(currentPost.timestamp)}</span>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-900 mb-4">${currentPost.title}</h1>
                    <div class="flex items-center gap-4 text-sm text-gray-600 mb-6">
                        <span class="font-medium">${currentPost.author}</span>
                        <div class="flex items-center gap-4">
                            <button onclick="likePost(${currentPost.id})" class="flex items-center gap-1 ${likedPosts.has(currentPost.id) ? 'text-blue-600' : 'text-gray-500'} hover:text-blue-600 transition-colors">
                                👍 <span>${currentPost.likes}</span>
                            </button>
                            <button onclick="dislikePost(${currentPost.id})" class="flex items-center gap-1 ${dislikedPosts.has(currentPost.id) ? 'text-red-600' : 'text-gray-500'} hover:text-red-600 transition-colors">
                                👎 <span>${currentPost.dislikes}</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="prose max-w-none mb-8">
                    <p class="text-gray-800 leading-relaxed">${currentPost.content}</p>
                </div>

                <div class="border-t pt-6">
                    <h3 class="text-lg font-semibold mb-4">댓글 ${currentPost.comments.length}개</h3>
                    
                    <div class="mb-6">
                        <div class="flex gap-3">
                            <input type="text" id="commentInput" placeholder="댓글을 입력하세요" class="flex-1 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" onkeypress="if(event.key==='Enter') addPostComment()">
                            <button onclick="addPostComment()" class="btn-primary px-6 py-2 rounded-md font-medium">
                                작성
                            </button>
                        </div>
                    </div>

                    <div class="space-y-4">
                        ${currentPost.comments.map(comment => `
                            <div class="bg-gray-50 rounded-lg p-4">
                                <div class="flex justify-between items-start mb-2">
                                    <span class="font-medium text-blue-600">${comment.author}</span>
                                    <span class="text-xs text-gray-500">${getTimeAgo(comment.timestamp)}</span>
                                </div>
                                <p class="text-gray-800">${comment.content}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // 모든 섹션 숨기고 글 상세 표시
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById('postDetailSection').classList.remove('hidden');
        }

        // 투표 목록 표시
        function displayPolls() {
            document.getElementById('pollsList').innerHTML = polls.map(poll => {
                const totalVotes = poll.votes.reduce((a, b) => a + b, 0);
                const hasVoted = votedPolls.has(poll.id);
                
                return `
                    <div class="card rounded-lg p-6">
                        <div class="flex justify-between items-start mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 flex-1 pr-4">${poll.title}</h3>
                            <div class="text-right text-sm text-gray-500">
                                <div>${getTimeAgo(poll.timestamp)}</div>
                                <div>총 ${totalVotes}표</div>
                            </div>
                        </div>
                        
                        <div class="space-y-3 mb-4">
                            ${poll.options.map((option, index) => {
                                const percentage = totalVotes > 0 ? Math.round((poll.votes[index] / totalVotes) * 100) : 0;
                                return `
                                    <button onclick="vote(${poll.id}, ${index})" class="vote-option w-full text-left p-4 rounded-lg transition-all duration-300 ${hasVoted ? 'cursor-not-allowed' : ''}" ${hasVoted ? 'disabled' : ''}>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-medium text-gray-800">${option}</span>
                                            <div class="text-right">
                                                <div class="font-bold text-blue-600">${percentage}%</div>
                                                <div class="text-sm text-gray-500">${poll.votes[index]}표</div>
                                            </div>
                                        </div>
                                        <div class="bg-gray-200 rounded-full h-2 overflow-hidden">
                                            <div class="progress-bar h-2 rounded-full transition-all duration-1000 ease-out" style="width: ${percentage}%"></div>
                                        </div>
                                    </button>
                                `;
                            }).join('')}
                        </div>
                        
                        ${hasVoted ? '<div class="flex items-center text-green-600 font-medium text-sm"><span class="mr-2">✅</span>투표 완료</div>' : ''}
                    </div>
                `;
            }).join('');
        }

        // 검색 관련 함수들
        function displaySearch() {
            // 검색 페이지 초기화
        }

        function setSearchFilter(filter) {
            searchFilter = filter;
            
            // 모든 필터 버튼 초기화
            document.querySelectorAll('.search-filter').forEach(btn => {
                btn.className = 'search-filter px-4 py-2 text-sm rounded-md border text-gray-600 hover:bg-gray-50';
            });
            
            // 선택된 필터 버튼 활성화
            document.getElementById('filter' + filter.charAt(0).toUpperCase() + filter.slice(1)).className = 'search-filter px-4 py-2 text-sm rounded-md border active';
            
            // 검색어가 있으면 다시 검색
            const searchInput = document.getElementById('searchInput');
            if (searchInput.value.trim()) {
                performSearch();
            }
        }

        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
            
            if (!searchTerm) {
                alert('검색어를 입력해주세요!');
                return;
            }

            let results = [];

            // 글 검색
            if (searchFilter === 'all' || searchFilter === 'posts') {
                const matchingPosts = posts.filter(post => 
                    post.title.toLowerCase().includes(searchTerm) ||
                    post.content.toLowerCase().includes(searchTerm) ||
                    post.author.toLowerCase().includes(searchTerm)
                );

                results = results.concat(matchingPosts.map(post => ({
                    type: 'post',
                    data: post
                })));
            }

            // 투표 검색
            if (searchFilter === 'all' || searchFilter === 'polls') {
                const matchingPolls = polls.filter(poll =>
                    poll.title.toLowerCase().includes(searchTerm) ||
                    poll.options.some(option => option.toLowerCase().includes(searchTerm))
                );

                results = results.concat(matchingPolls.map(poll => ({
                    type: 'poll',
                    data: poll
                })));
            }

            // 결과를 시간순으로 정렬
            results.sort((a, b) => b.data.timestamp - a.data.timestamp);

            displaySearchResults(results, searchTerm);
        }

        function displaySearchResults(results, searchTerm) {
            const resultsContainer = document.getElementById('searchResults');
            
            if (results.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <div class="text-4xl mb-4">😔</div>
                        <p>"${searchTerm}"에 대한 검색 결과가 없습니다.</p>
                    </div>
                `;
                return;
            }

            resultsContainer.innerHTML = `
                <div class="mb-4">
                    <h3 class="font-semibold text-gray-900 mb-2">검색 결과 ${results.length}개</h3>
                    <p class="text-sm text-gray-600">검색어: "${searchTerm}"</p>
                </div>
                <div class="space-y-4">
                    ${results.map(result => {
                        if (result.type === 'post') {
                            const post = result.data;
                            const gallery = galleries.find(g => g.id === post.galleryId);
                            return `
                                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 cursor-pointer border-l-4 border-l-blue-500" onclick="showPostDetail(${post.id})">
                                    <div class="flex items-start justify-between mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="tag px-2 py-1 rounded text-xs font-medium">글</span>
                                            <span>${gallery.icon}</span>
                                            <span class="text-sm text-gray-600">${gallery.name}</span>
                                        </div>
                                        <div class="text-sm text-gray-500">${getTimeAgo(post.timestamp)}</div>
                                    </div>
                                    <h4 class="font-medium text-gray-900 mb-2">${highlightSearchTerm(post.title, searchTerm)}</h4>
                                    <p class="text-gray-600 text-sm mb-2 line-clamp-2">${highlightSearchTerm(post.content, searchTerm)}</p>
                                    <div class="flex items-center justify-between text-sm text-gray-500">
                                        <span>작성자: ${highlightSearchTerm(post.author, searchTerm)}</span>
                                        <div class="flex items-center gap-3">
                                            <span>👍 ${post.likes}</span>
                                            <span>💬 ${post.comments.length}</span>
                                        </div>
                                    </div>
                                </div>
                            `;
                        } else if (result.type === 'poll') {
                            const poll = result.data;
                            const totalVotes = poll.votes.reduce((a, b) => a + b, 0);
                            return `
                                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 cursor-pointer border-l-4 border-l-purple-500" onclick="showSection('votes')">
                                    <div class="flex items-start justify-between mb-2">
                                        <span class="tag px-2 py-1 rounded text-xs font-medium bg-purple-50 text-purple-700 border-purple-200">투표</span>
                                        <div class="text-sm text-gray-500">${getTimeAgo(poll.timestamp)}</div>
                                    </div>
                                    <h4 class="font-medium text-gray-900 mb-3">${highlightSearchTerm(poll.title, searchTerm)}</h4>
                                    <div class="space-y-1 mb-2">
                                        ${poll.options.map((option, index) => {
                                            const percentage = totalVotes > 0 ? Math.round((poll.votes[index] / totalVotes) * 100) : 0;
                                            return `
                                                <div class="flex justify-between items-center text-sm">
                                                    <span>${highlightSearchTerm(option, searchTerm)}</span>
                                                    <span class="text-blue-600 font-medium">${percentage}% (${poll.votes[index]}표)</span>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                    <div class="text-sm text-gray-500">
                                        총 ${totalVotes}표 참여
                                    </div>
                                </div>
                            `;
                        }
                    }).join('')}
                </div>
            `;
        }

        function highlightSearchTerm(text, searchTerm) {
            if (!searchTerm) return text;
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark class="bg-yellow-200 px-1">$1</mark>');
        }

        // 유틸리티 함수들
        function toggleCreateForm() {
            const form = document.getElementById('createForm');
            form.classList.toggle('hidden');
        }

        function toggleWriteForm() {
            const form = document.getElementById('writeForm');
            form.classList.toggle('hidden');
        }

        function createPoll() {
            const title = document.getElementById('pollTitle').value.trim();
            const option1 = document.getElementById('option1').value.trim();
            const option2 = document.getElementById('option2').value.trim();

            if (!title || !option1 || !option2) {
                alert('모든 필드를 입력해주세요!');
                return;
            }

            const newPoll = {
                id: polls.length + 1,
                title: title,
                options: [option1, option2],
                votes: [0, 0],
                tags: [],
                timestamp: Date.now(),
                comments: []
            };

            polls.unshift(newPoll);
            
            document.getElementById('pollTitle').value = '';
            document.getElementById('option1').value = '';
            document.getElementById('option2').value = '';
            
            toggleCreateForm();
            displayPolls();
            alert('투표가 생성되었습니다!');
        }

        function createPost() {
            const title = document.getElementById('postTitle').value.trim();
            const content = document.getElementById('postContent').value.trim();

            if (!title || !content) {
                alert('제목과 내용을 모두 입력해주세요!');
                return;
            }

            const nicknames = ['익명의 작성자', '신비한 글쓴이', '열정적인 참여자', '진실한 마음', '따뜻한 시선'];
            
            const newPost = {
                id: postIdCounter++,
                galleryId: currentGallery.id,
                title: title,
                content: content,
                author: nicknames[Math.floor(Math.random() * nicknames.length)],
                timestamp: Date.now(),
                likes: 0,
                dislikes: 0,
                comments: []
            };

            posts.unshift(newPost);
            
            document.getElementById('postTitle').value = '';
            document.getElementById('postContent').value = '';
            
            toggleWriteForm();
            showGalleryDetail(currentGallery.id);
            alert('글이 작성되었습니다!');
        }

        function vote(pollId, optionIndex) {
            if (votedPolls.has(pollId)) {
                alert('이미 투표하셨습니다!');
                return;
            }

            const poll = polls.find(p => p.id === pollId);
            if (poll) {
                poll.votes[optionIndex]++;
                votedPolls.add(pollId);
                displayPolls();
            }
        }

        function likePost(postId) {
            if (likedPosts.has(postId)) {
                alert('이미 좋아요를 누르셨습니다!');
                return;
            }

            const post = posts.find(p => p.id === postId);
            if (post) {
                if (dislikedPosts.has(postId)) {
                    post.dislikes--;
                    dislikedPosts.delete(postId);
                }
                post.likes++;
                likedPosts.add(postId);
                showPostDetail(postId);
            }
        }

        function dislikePost(postId) {
            if (dislikedPosts.has(postId)) {
                alert('이미 싫어요를 누르셨습니다!');
                return;
            }

            const post = posts.find(p => p.id === postId);
            if (post) {
                if (likedPosts.has(postId)) {
                    post.likes--;
                    likedPosts.delete(postId);
                }
                post.dislikes++;
                dislikedPosts.add(postId);
                showPostDetail(postId);
            }
        }

        function addPostComment() {
            const commentText = document.getElementById('commentInput').value.trim();
            if (!commentText) {
                alert('댓글을 입력해주세요!');
                return;
            }

            const nicknames = ['익명의 댓글러', '신비한 방문자', '열정적인 독자', '진실한 마음', '따뜻한 시선'];
            
            const newComment = {
                id: commentIdCounter++,
                content: commentText,
                author: nicknames[Math.floor(Math.random() * nicknames.length)],
                timestamp: Date.now()
            };

            currentPost.comments.push(newComment);
            document.getElementById('commentInput').value = '';
            showPostDetail(currentPost.id);
        }

        function goBackToGallery() {
            if (currentGallery) {
                showGalleryDetail(currentGallery.id);
            } else {
                showSection('galleries');
            }
        }

        function getTimeAgo(timestamp) {
            const now = Date.now();
            const diff = now - timestamp;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);

            if (days > 0) return `${days}일 전`;
            if (hours > 0) return `${hours}시간 전`;
            if (minutes > 0) return `${minutes}분 전`;
            return '방금 전';
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9709996093a3aa53',t:'MTc1NTQzODE5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
