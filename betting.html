<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VirtSports - ê°€ìƒ ìŠ¤í¬ì¸  ë² íŒ… í”Œë«í¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: #0f0f0f;
            color: #e5e5e5;
            line-height: 1.6;
        }
        
        .card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;
        }
        
        .card:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
        }
        
        .btn {
            background: #007bff;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            font-weight: 500;
            font-size: 14px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .btn:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-success:hover {
            background: #1e7e34;
        }
        
        .odds-btn {
            background: #2a2a2a;
            border: 2px solid #444;
            border-radius: 6px;
            padding: 12px;
            font-weight: 600;
            color: #e5e5e5;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .odds-btn:hover {
            background: #333;
            border-color: #007bff;
            color: #007bff;
        }
        
        .odds-btn.selected {
            background: #007bff;
            border-color: #007bff;
            color: white;
        }
        
        .live-indicator {
            color: #dc3545;
        }
        
        .nav-btn {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 10px 20px;
            font-weight: 500;
            color: #e5e5e5;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .nav-btn:hover {
            background: #333;
            color: #007bff;
        }
        
        .nav-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .rank-gold { color: #ffd700; }
        .rank-silver { color: #c0c0c0; }
        .rank-bronze { color: #cd7f32; }
        
        .progress-bar {
            background: #007bff;
            height: 4px;
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        
        .stats-card {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 16px;
            text-align: center;
        }
        
        .form-input {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 10px 12px;
            color: #e5e5e5;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }
        
        .modal-backdrop {
            background: rgba(0, 0, 0, 0.5);
        }
        
        .sport-icon {
            font-size: 1.5rem;
        }
        
        .table-row {
            border-bottom: 1px solid #444;
            transition: background-color 0.2s ease;
        }
        
        .table-row:hover {
            background: #2a2a2a;
        }
        
        .match-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            transition: all 0.2s ease;
        }
        
        .match-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <header class="bg-gray-900 border-b border-gray-700 shadow-sm">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-3">
                        <div class="sport-icon">âš½</div>
                        <div>
                            <h1 class="text-2xl font-bold text-white">VirtSports</h1>
                            <p class="text-gray-300 text-sm">ê°€ìƒ ìŠ¤í¬ì¸  ë² íŒ…</p>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center gap-4">
                    <div class="stats-card">
                        <div class="text-blue-600 font-bold text-lg" id="userPoints">10,000</div>
                        <div class="text-gray-300 text-sm">í¬ì¸íŠ¸</div>
                    </div>
                    <div class="stats-card">
                        <div class="text-green-400 font-bold text-lg" id="userRank">#1</div>
                        <div class="text-gray-300 text-sm">ìˆœìœ„</div>
                    </div>
                    <button onclick="showRankings()" class="btn">
                        ì „ì²´ ë­í‚¹
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 py-6">
        <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
        <nav class="mb-6">
            <div class="card p-3">
                <div class="flex gap-2">
                    <button onclick="showSection('live')" id="liveBtn" class="nav-btn active">
                        <span class="live-indicator">â—</span> ë¼ì´ë¸Œ ê²½ê¸°
                    </button>
                    <button onclick="showSection('upcoming')" id="upcomingBtn" class="nav-btn">
                        ì˜ˆì • ê²½ê¸°
                    </button>
                    <button onclick="showSection('history')" id="historyBtn" class="nav-btn">
                        ë² íŒ… ë‚´ì—­
                    </button>
                </div>
            </div>
        </nav>

        <!-- ë¼ì´ë¸Œ ê²½ê¸° ì„¹ì…˜ -->
        <div id="liveSection" class="section">
            <div class="grid lg:grid-cols-3 gap-8">
                <!-- ê²½ê¸° ëª©ë¡ -->
                <div class="lg:col-span-2">
                    <div class="card p-6 mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-bold text-white flex items-center gap-2">
                                <span class="live-indicator">â—</span> 
                                ë¼ì´ë¸Œ ê²½ê¸°
                            </h2>
                            <div class="text-sm text-gray-400">
                                ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
                            </div>
                        </div>
                        
                        <div id="liveMatches" class="space-y-6">
                            <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                        </div>
                    </div>
                </div>

                <!-- ë² íŒ… ìŠ¬ë¦½ & ìˆœìœ„ -->
                <div class="space-y-8">
                    <!-- ë² íŒ… ìŠ¬ë¦½ -->
                    <div class="card p-4">
                        <h3 class="text-lg font-bold text-white mb-4">ë² íŒ… ìŠ¬ë¦½</h3>
                        <div id="bettingSlip">
                            <div class="text-center text-gray-400 py-8">
                                <div class="text-4xl mb-3">ğŸ²</div>
                                <p>ê²½ê¸°ë¥¼ ì„ íƒí•˜ì—¬<br>ë² íŒ…ì„ ì‹œì‘í•˜ì„¸ìš”!</p>
                            </div>
                        </div>
                    </div>

                    <!-- ì‹¤ì‹œê°„ ìˆœìœ„ -->
                    <div class="card p-4">
                        <h3 class="text-lg font-bold text-white mb-4">TOP 5 ë­í‚¹</h3>
                        <div id="topRankings" class="space-y-3">
                            <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì˜ˆì • ê²½ê¸° ì„¹ì…˜ -->
        <div id="upcomingSection" class="section hidden">
            <div class="card p-6">
                <h2 class="text-xl font-bold text-white mb-6">ì˜ˆì •ëœ ê²½ê¸°</h2>
                <div id="upcomingMatches" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                </div>
            </div>
        </div>

        <!-- ë² íŒ… ë‚´ì—­ ì„¹ì…˜ -->
        <div id="historySection" class="section hidden">
            <div class="card p-6">
                <h2 class="text-xl font-bold text-white mb-6">ë‚˜ì˜ ë² íŒ… ë‚´ì—­</h2>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-4 py-3 text-left text-gray-700 font-semibold">ê²½ê¸°</th>
                                <th class="px-4 py-3 text-left text-gray-700 font-semibold">ë² íŒ…</th>
                                <th class="px-4 py-3 text-left text-gray-700 font-semibold">ë°°ë‹¹</th>
                                <th class="px-4 py-3 text-left text-gray-700 font-semibold">í¬ì¸íŠ¸</th>
                                <th class="px-4 py-3 text-left text-gray-700 font-semibold">ê²°ê³¼</th>
                            </tr>
                        </thead>
                        <tbody id="bettingHistory">
                            <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ë­í‚¹ ëª¨ë‹¬ -->
    <div id="rankingModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="card p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-gray-900">ì „ì²´ ë­í‚¹</h2>
                <button onclick="hideRankings()" class="btn">Ã—</button>
            </div>
            <div id="fullRankings" class="space-y-3">
                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
            </div>
        </div>
    </div>

    <!-- ê´€ë¦¬ì íŒ¨ë„ ëª¨ë‹¬ -->
    <div id="adminModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="card rounded-xl p-8 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-white">âš™ï¸ ê´€ë¦¬ì íŒ¨ë„</h2>
                <button onclick="hideAdminPanel()" class="text-slate-400 hover:text-white text-2xl">&times;</button>
            </div>
            
            <div class="space-y-6">
                <!-- í¬ì¸íŠ¸ ê´€ë¦¬ -->
                <div class="bg-slate-700 rounded-lg p-6">
                    <h3 class="text-lg font-bold text-white mb-4">ğŸ’° í¬ì¸íŠ¸ ê´€ë¦¬</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-slate-300 mb-2">í¬ì¸íŠ¸ ì¶”ê°€/ì°¨ê°</label>
                            <input type="number" id="pointsToAdd" placeholder="í¬ì¸íŠ¸ ì…ë ¥" class="w-full bg-slate-600 border border-slate-500 rounded-lg px-4 py-2 text-white">
                        </div>
                        <div class="flex gap-2">
                            <button onclick="addPoints()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg font-medium">
                                â• ì¶”ê°€
                            </button>
                            <button onclick="removePoints()" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-medium">
                                â– ì°¨ê°
                            </button>
                        </div>
                    </div>
                    <div class="mt-4 flex gap-2">
                        <button onclick="setPoints(50000)" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">
                            50,000P ì„¤ì •
                        </button>
                        <button onclick="setPoints(100000)" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">
                            100,000P ì„¤ì •
                        </button>
                        <button onclick="resetPoints()" class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-sm">
                            ì´ˆê¸°í™” (10,000P)
                        </button>
                    </div>
                </div>

                <!-- ê²½ê¸° ê´€ë¦¬ -->
                <div class="bg-slate-700 rounded-lg p-6">
                    <h3 class="text-lg font-bold text-white mb-4">âš½ ê²½ê¸° ê´€ë¦¬</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <button onclick="forceCreateMatch()" class="bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-medium">
                            ğŸ†• ìƒˆ ê²½ê¸° ìƒì„±
                        </button>
                        <button onclick="endAllMatches()" class="bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg font-medium">
                            ğŸ›‘ ëª¨ë“  ê²½ê¸° ì¢…ë£Œ
                        </button>
                    </div>
                    <div class="mt-4">
                        <button onclick="createSpecialEvent()" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg font-medium">
                            âœ¨ íŠ¹ë³„ ì´ë²¤íŠ¸ ê²½ê¸° ìƒì„±
                        </button>
                    </div>
                </div>

                <!-- ì‹œìŠ¤í…œ ê´€ë¦¬ -->
                <div class="bg-slate-700 rounded-lg p-6">
                    <h3 class="text-lg font-bold text-white mb-4">ğŸ”§ ì‹œìŠ¤í…œ ê´€ë¦¬</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <button onclick="resetAllData()" class="bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg font-medium">
                            ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
                        </button>
                        <button onclick="exportData()" class="bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-medium">
                            ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
                        </button>
                    </div>
                </div>

                <!-- í˜„ì¬ ìƒíƒœ -->
                <div class="bg-slate-700 rounded-lg p-6">
                    <h3 class="text-lg font-bold text-white mb-4">ğŸ“Š í˜„ì¬ ìƒíƒœ</h3>
                    <div class="grid md:grid-cols-3 gap-4 text-center">
                        <div>
                            <div class="text-2xl font-bold text-green-400" id="adminLiveCount">0</div>
                            <div class="text-slate-300 text-sm">ì§„í–‰ ì¤‘ ê²½ê¸°</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-blue-400" id="adminUpcomingCount">0</div>
                            <div class="text-slate-300 text-sm">ì˜ˆì • ê²½ê¸°</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-yellow-400" id="adminBetCount">0</div>
                            <div class="text-slate-300 text-sm">í™œì„± ë² íŒ…</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë² íŒ… í™•ì¸ ëª¨ë‹¬ -->
    <div id="betModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50">
        <div class="card p-6 max-w-md w-full mx-4">
            <h3 class="text-lg font-bold text-gray-900 mb-4">ë² íŒ… í™•ì¸</h3>
            <div id="betDetails" class="space-y-3 mb-6">
                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
            </div>
            <div class="mb-6">
                <label class="block text-gray-700 font-medium mb-2">ë² íŒ… í¬ì¸íŠ¸</label>
                <input type="number" id="betAmount" min="100" max="5000" value="1000" class="w-full form-input">
                <div class="text-sm text-gray-500 mt-1">ìµœì†Œ 100P ~ ìµœëŒ€ 5,000P</div>
            </div>
            <div class="flex gap-3">
                <button onclick="confirmBet()" class="flex-1 btn btn-success">
                    ë² íŒ… í™•ì •
                </button>
                <button onclick="cancelBet()" class="flex-1 btn" style="background: #6c757d;">
                    ì·¨ì†Œ
                </button>
            </div>
        </div>
    </div>

    <script>
        // ê²Œì„ ìƒíƒœ
        let userPoints = 10000;
        let currentBets = [];
        let bettingHistory = [];
        let liveMatches = [];
        let upcomingMatches = [];
        let rankings = [];
        let selectedBet = null;

        // ìŠ¤í¬ì¸  ì¢…ëª©ê³¼ íŒ€ ë°ì´í„°
        const sports = ['ì¶•êµ¬', 'ë†êµ¬', 'ì•¼êµ¬', 'í…Œë‹ˆìŠ¤', 'ë°°êµ¬', 'ë§ê²½ê¸°', 'ê°œê²½ê¸°'];
        const teams = {
            'ì¶•êµ¬': ['ë ˆì•Œ ë§ˆë“œë¦¬ë“œ', 'ë°”ë¥´ì…€ë¡œë‚˜', 'ë§¨ì²´ìŠ¤í„° ìœ ë‚˜ì´í‹°ë“œ', 'ë¦¬ë²„í’€', 'ë°”ì´ì—ë¥¸ ë®Œí—¨', 'íŒŒë¦¬ ìƒì œë¥´ë§¹', 'ìœ ë²¤íˆ¬ìŠ¤', 'ì²¼ì‹œ'],
            'ë†êµ¬': ['ë ˆì´ì»¤ìŠ¤', 'ì›Œë¦¬ì–´ìŠ¤', 'ì…€í‹±ìŠ¤', 'ë„¤ì¸ ', 'íˆíŠ¸', 'ë²…ìŠ¤', 'ì„ ì¦ˆ', 'ë„ˆê²Ÿì¸ '],
            'ì•¼êµ¬': ['ì–‘í‚¤ìŠ¤', 'ë‹¤ì €ìŠ¤', 'ë ˆë“œì‚­ìŠ¤', 'ìì´ì–¸ì¸ ', 'ì• ìŠ¤íŠ¸ë¡œìŠ¤', 'ë¸Œë ˆì´ë¸ŒìŠ¤', 'íŒ¨ë“œë¦¬ìŠ¤', 'ë©”ì¸ '],
            'í…Œë‹ˆìŠ¤': ['ë…¸ë°”í¬ ì¡°ì½”ë¹„ì¹˜', 'ë¼íŒŒì—˜ ë‚˜ë‹¬', 'ë¡œì € í˜ë”ëŸ¬', 'ë‹¤ë‹ ë©”ë“œë² ë°í”„', 'ì•Œë ‰ì‚°ë” ì¦ˆë² ë ˆí”„', 'ìŠ¤í…ŒíŒŒë…¸ìŠ¤ ì¹˜ì¹˜íŒŒìŠ¤'],
            'ë°°êµ¬': ['í•œêµ­ì „ë ¥', 'KBì†í•´ë³´í—˜', 'í˜„ëŒ€ìºí”¼íƒˆ', 'ìš°ë¦¬ì¹´ë“œ', 'ì‚¼ì„±í™”ì¬', 'OKê¸ˆìœµê·¸ë£¹'],
            'ë§ê²½ê¸°': ['ì¬ë”ë³¼íŠ¸', 'ê³¨ë“ ìŠ¤í”¼ë“œ', 'ë¡œì—´í”„ë¦°ìŠ¤', 'íŒŒì´ì–´ìŠ¤í†°', 'ìœˆë“œëŸ¬ë„ˆ', 'ë¸”ë™ë‹¤ì´ì•„ëª¬ë“œ', 'ì‹¤ë²„ë¶ˆë¦¿', 'ë ˆë“œí”Œë˜ì‹œ', 'ìŠ¤íƒ€ë¼ì´íŠ¸', 'ë“œë¦¼ì²´ì´ì„œ'],
            'ê°œê²½ê¸°': ['ìŠ¤í”¼ë“œí‚¹', 'ëŸ­í‚¤ë…', 'í”Œë˜ì‹œ', 'í„°ë³´', 'ë¡œì¼“', 'ë¶ˆë¦¿', 'ë¼ì´íŠ¸ë‹', 'ìŠ¤í†°', 'ë¸”ë ˆì´ì¦ˆ', 'ì²´ì´ì„œ']
        };

        // ì´ˆê¸°í™”
        function init() {
            console.log('init í•¨ìˆ˜ ì‹œì‘');
            loadUserData();
            
            // ê²½ê¸° ê°•ì œ ìƒì„±
            liveMatches = [];
            for (let i = 0; i < 3; i++) {
                const match = createRandomMatch(true);
                liveMatches.push(match);
                console.log('ìƒì„±ëœ ê²½ê¸° ' + (i+1) + ':', match);
            }
            
            generateUpcomingMatches();
            generateRankings();
            
            console.log('ì´ ë¼ì´ë¸Œ ê²½ê¸° ìˆ˜:', liveMatches.length);
            
            // ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸
            updateLiveMatches();
            updateUpcomingMatches();
            updateUI();
        }

        // ì‚¬ìš©ì ë°ì´í„° ë¡œë“œ
        function loadUserData() {
            const saved = localStorage.getItem('virtSportsData');
            if (saved) {
                const data = JSON.parse(saved);
                userPoints = data.userPoints || 10000;
                bettingHistory = data.bettingHistory || [];
                rankings = data.rankings || [];
            }
            
            // ì´ˆê¸° ë­í‚¹ ìƒì„±
            if (rankings.length === 0) {
                generateInitialRankings();
            }
        }

        // ë°ì´í„° ì €ì¥
        function saveUserData() {
            const data = {
                userPoints: userPoints,
                bettingHistory: bettingHistory,
                rankings: rankings
            };
            localStorage.setItem('virtSportsData', JSON.stringify(data));
        }

        // ë¼ì´ë¸Œ ê²½ê¸° ìƒì„±
        function generateLiveMatches() {
            console.log('ë¼ì´ë¸Œ ê²½ê¸° ìƒì„± ì‹œì‘');
            liveMatches = [];
            for (let i = 0; i < 3; i++) {
                const match = createRandomMatch(true);
                console.log('ìƒì„±ëœ ê²½ê¸°:', match);
                liveMatches.push(match);
            }
            console.log('ì´ ìƒì„±ëœ ë¼ì´ë¸Œ ê²½ê¸° ìˆ˜:', liveMatches.length);
        }

        // ì˜ˆì • ê²½ê¸° ìƒì„±
        function generateUpcomingMatches() {
            upcomingMatches = [];
            for (let i = 0; i < 6; i++) {
                const match = createRandomMatch(false);
                match.startTime = Date.now() + (i + 1) * 300000; // 5ë¶„ ê°„ê²©
                upcomingMatches.push(match);
            }
        }

        // ëœë¤ ê²½ê¸° ìƒì„±
        function createRandomMatch(isLive = false) {
            const sport = sports[Math.floor(Math.random() * sports.length)];
            const sportTeams = teams[sport];
            
            // ê²½ë§ˆ/ê°œê²½ê¸°ëŠ” ë‹¤ì¤‘ ì°¸ê°€ì ë ˆì´ìŠ¤
            if (sport === 'ë§ê²½ê¸°' || sport === 'ê°œê²½ê¸°') {
                const participants = [];
                const numParticipants = Math.floor(Math.random() * 4) + 6; // 6-9ë§ˆë¦¬
                
                for (let i = 0; i < numParticipants; i++) {
                    let participant = sportTeams[Math.floor(Math.random() * sportTeams.length)];
                    while (participants.some(p => p.name === participant)) {
                        participant = sportTeams[Math.floor(Math.random() * sportTeams.length)];
                    }
                    
                    participants.push({
                        name: participant,
                        number: i + 1,
                        odds: (Math.random() * 8 + 1.5).toFixed(2), // 1.5ë°° ~ 9.5ë°°
                        position: isLive ? Math.floor(Math.random() * 100) : 0
                    });
                }
                
                // ë°°ë‹¹ë¥  ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ë‚®ì€ ë°°ë‹¹ë¥ ì´ 1ë“± í›„ë³´)
                participants.sort((a, b) => parseFloat(a.odds) - parseFloat(b.odds));
                
                const match = {
                    id: Date.now() + Math.random(),
                    sport: sport,
                    isRace: true,
                    participants: participants,
                    isLive: isLive,
                    startTime: isLive ? Date.now() : null,
                    duration: 180000, // 3ë¶„
                    raceDistance: sport === 'ë§ê²½ê¸°' ? '1200m' : '500m'
                };
                
                return match;
            }
            
            // ì¼ë°˜ ìŠ¤í¬ì¸  (ê¸°ì¡´ ë¡œì§)
            const team1 = sportTeams[Math.floor(Math.random() * sportTeams.length)];
            let team2 = sportTeams[Math.floor(Math.random() * sportTeams.length)];
            while (team2 === team1) {
                team2 = sportTeams[Math.floor(Math.random() * sportTeams.length)];
            }

            const match = {
                id: Date.now() + Math.random(),
                sport: sport,
                team1: team1,
                team2: team2,
                odds1: (Math.random() * 2 + 1.2).toFixed(2),
                odds2: (Math.random() * 2 + 1.2).toFixed(2),
                oddsDraw: sport !== 'í…Œë‹ˆìŠ¤' ? (Math.random() * 1.5 + 2.5).toFixed(2) : null,
                isLive: isLive,
                startTime: isLive ? Date.now() : null,
                duration: 180000, // 3ë¶„
                score1: isLive ? Math.floor(Math.random() * 3) : 0,
                score2: isLive ? Math.floor(Math.random() * 3) : 0
            };

            return match;
        }

        // ìƒˆë¡œìš´ ê²½ê¸° ìƒì„±
        function generateNewMatch() {
            // ë¼ì´ë¸Œ ê²½ê¸°ê°€ 3ê°œ ë¯¸ë§Œì´ë©´ ì¶”ê°€
            if (liveMatches.length < 3) {
                liveMatches.push(createRandomMatch(true));
            }
            
            // ì˜ˆì • ê²½ê¸° ì¶”ê°€
            if (upcomingMatches.length < 6) {
                const match = createRandomMatch(false);
                match.startTime = Date.now() + 300000;
                upcomingMatches.push(match);
            }
            
            updateLiveMatches();
            updateUpcomingMatches();
        }

        // ê²½ê¸° ê²°ê³¼ ì²˜ë¦¬
        function processMatchResults() {
            liveMatches.forEach(match => {
                if (Date.now() - match.startTime >= match.duration) {
                    let winner;
                    
                    if (match.isRace) {
                        // ê²½ë§ˆ/ê°œê²½ê¸° ê²°ê³¼ ì²˜ë¦¬
                        // ë°°ë‹¹ë¥ ì´ ë‚®ì„ìˆ˜ë¡ ìš°ìŠ¹ í™•ë¥  ë†’ìŒ
                        const totalWeight = match.participants.reduce((sum, p) => {
                            return sum + (10 / parseFloat(p.odds)); // ë°°ë‹¹ë¥  ì—­ìˆ˜ë¡œ ê°€ì¤‘ì¹˜
                        }, 0);
                        
                        let random = Math.random() * totalWeight;
                        for (let participant of match.participants) {
                            random -= (10 / parseFloat(participant.odds));
                            if (random <= 0) {
                                winner = participant.number;
                                break;
                            }
                        }
                    } else {
                        // ì¼ë°˜ ìŠ¤í¬ì¸  ê²°ê³¼ ì²˜ë¦¬
                        const result = Math.random();
                        if (result < 0.4) winner = 'team1';
                        else if (result < 0.8) winner = 'team2';
                        else winner = 'draw';
                    }
                    
                    // ë² íŒ… ê²°ê³¼ ì²˜ë¦¬
                    processBettingResults(match.id, winner);
                }
            });
            
            // ì¢…ë£Œëœ ê²½ê¸° ì œê±°
            liveMatches = liveMatches.filter(match => 
                Date.now() - match.startTime < match.duration
            );
            
            updateLiveMatches();
        }

        // ë² íŒ… ê²°ê³¼ ì²˜ë¦¬
        function processBettingResults(matchId, winner) {
            currentBets.forEach(bet => {
                if (bet.matchId === matchId) {
                    let won = false;
                    
                    if (bet.isRace) {
                        // ê²½ë§ˆ/ê°œê²½ê¸° ë² íŒ… ê²°ê³¼
                        if (bet.participantNumber === winner) {
                            won = true;
                            const winAmount = Math.floor(bet.amount * bet.odds);
                            userPoints += winAmount;
                            
                            // ìŠ¹ë¦¬ ì• ë‹ˆë©”ì´ì…˜
                            showWinAnimation(winAmount);
                        }
                    } else {
                        // ì¼ë°˜ ìŠ¤í¬ì¸  ë² íŒ… ê²°ê³¼
                        if ((bet.type === 'team1' && winner === 'team1') ||
                            (bet.type === 'team2' && winner === 'team2') ||
                            (bet.type === 'draw' && winner === 'draw')) {
                            won = true;
                            const winAmount = Math.floor(bet.amount * bet.odds);
                            userPoints += winAmount;
                            
                            // ìŠ¹ë¦¬ ì• ë‹ˆë©”ì´ì…˜
                            showWinAnimation(winAmount);
                        }
                    }
                    
                    // ë² íŒ… ë‚´ì—­ì— ì¶”ê°€
                    bettingHistory.unshift({
                        ...bet,
                        result: won ? 'win' : 'lose',
                        timestamp: Date.now(),
                        winner: winner
                    });
                }
            });
            
            // ì²˜ë¦¬ëœ ë² íŒ… ì œê±°
            currentBets = currentBets.filter(bet => bet.matchId !== matchId);
            
            updateRankings();
            saveUserData();
            updateUI();
        }

        // ìŠ¹ë¦¬ ì• ë‹ˆë©”ì´ì…˜
        function showWinAnimation(amount) {
            const pointsElement = document.getElementById('userPoints');
            pointsElement.classList.add('celebration');
            
            // í”Œë¡œíŒ… í¬ì¸íŠ¸ í‘œì‹œ
            const floatingPoints = document.createElement('div');
            floatingPoints.className = 'floating-points fixed text-green-400 font-bold text-2xl z-50';
            floatingPoints.textContent = `+${amount}P`;
            floatingPoints.style.left = pointsElement.getBoundingClientRect().left + 'px';
            floatingPoints.style.top = pointsElement.getBoundingClientRect().top + 'px';
            document.body.appendChild(floatingPoints);
            
            setTimeout(() => {
                pointsElement.classList.remove('celebration');
                floatingPoints.remove();
            }, 2000);
        }

        // ë² íŒ…í•˜ê¸°
        function placeBet(matchId, type, odds, teamName, participantNumber = null) {
            const match = liveMatches.find(m => m.id === matchId);
            if (!match) return;
            
            selectedBet = {
                matchId: matchId,
                type: type,
                odds: parseFloat(odds),
                teamName: teamName,
                match: match,
                isRace: match.isRace || false,
                participantNumber: participantNumber
            };
            
            // ë² íŒ… ëª¨ë‹¬ í‘œì‹œ
            showBetModal();
        }

        // ë² íŒ… ëª¨ë‹¬ í‘œì‹œ
        function showBetModal() {
            const modal = document.getElementById('betModal');
            const details = document.getElementById('betDetails');
            
            details.innerHTML = `
                <div class="bg-slate-700 rounded-lg p-4">
                    <div class="text-white font-medium">${selectedBet.match.team1} vs ${selectedBet.match.team2}</div>
                    <div class="text-slate-300 text-sm">${selectedBet.match.sport}</div>
                    <div class="text-blue-400 font-bold mt-2">
                        ${selectedBet.teamName} (${selectedBet.odds}ë°°)
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // ë² íŒ… í™•ì •
        function confirmBet() {
            const amount = parseInt(document.getElementById('betAmount').value);
            
            if (amount < 100 || amount > 5000) {
                alert('ë² íŒ… í¬ì¸íŠ¸ëŠ” 100P ~ 5,000P ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            
            if (amount > userPoints) {
                alert('í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.');
                return;
            }
            
            // í¬ì¸íŠ¸ ì°¨ê°
            userPoints -= amount;
            
            // ë² íŒ… ì¶”ê°€
            currentBets.push({
                ...selectedBet,
                amount: amount,
                timestamp: Date.now()
            });
            
            cancelBet();
            updateUI();
            updateBettingHistory(); // ë² íŒ… ë‚´ì—­ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
            saveUserData();
            
            alert(`âœ… ë² íŒ…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n${amount}Pë¥¼ ë² íŒ…í–ˆìŠµë‹ˆë‹¤.`);
        }

        // ë² íŒ… ì·¨ì†Œ
        function cancelBet() {
            document.getElementById('betModal').classList.add('hidden');
            document.getElementById('betModal').classList.remove('flex');
            selectedBet = null;
        }

        // ì„¹ì…˜ ì „í™˜
        function showSection(section) {
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ì„ íƒëœ ì„¹ì…˜ í‘œì‹œ
            document.getElementById(section + 'Section').classList.remove('hidden');
            document.getElementById(section + 'Btn').classList.add('active');
            
            // ì„¹ì…˜ë³„ ë°ì´í„° ì—…ë°ì´íŠ¸
            if (section === 'history') {
                updateBettingHistory();
            } else if (section === 'live') {
                updateLiveMatches();
            } else if (section === 'upcoming') {
                updateUpcomingMatches();
            }
        }

        // ë¼ì´ë¸Œ ê²½ê¸° ì—…ë°ì´íŠ¸
        function updateLiveMatches() {
            console.log('ë¼ì´ë¸Œ ê²½ê¸° ì—…ë°ì´íŠ¸ ì‹œì‘, ê²½ê¸° ìˆ˜:', liveMatches.length);
            const container = document.getElementById('liveMatches');
            
            if (!container) {
                console.error('liveMatches ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                return;
            }
            
            if (liveMatches.length === 0) {
                console.log('ê²½ê¸°ê°€ ì—†ì–´ì„œ ë©”ì‹œì§€ í‘œì‹œ');
                container.innerHTML = `
                    <div class="text-center text-slate-400 py-8">
                        <div class="text-4xl mb-4">â°</div>
                        <p>í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ê²½ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                        <button onclick="generateLiveMatches(); updateLiveMatches();" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                            ê²½ê¸° ìƒì„±í•˜ê¸°
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = liveMatches.map(match => {
                const elapsed = Math.floor((Date.now() - match.startTime) / 1000);
                const remaining = Math.max(0, 180 - elapsed);
                const minutes = Math.floor(remaining / 60);
                const seconds = remaining % 60;
                
                if (match.isRace) {
                    // ê²½ë§ˆ/ê°œê²½ê¸° ë ˆì´ì•„ì›ƒ
                    return `
                        <div class="card p-6 mb-4">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center gap-3">
                                    <span class="sport-icon">${getSportIcon(match.sport)}</span>
                                    <div>
                                        <div class="text-gray-900 font-bold">${match.sport} - ${match.raceDistance}</div>
                                        <div class="text-red-600 text-sm flex items-center gap-1">
                                            <span class="live-indicator">â—</span> LIVE ë ˆì´ìŠ¤
                                        </div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-gray-900 font-bold">${match.participants.length}ë§ˆë¦¬</div>
                                    <div class="text-blue-600 font-medium">${minutes}:${seconds.toString().padStart(2, '0')}</div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-2 mb-4">
                                ${match.participants.map(participant => `
                                    <button onclick="placeBet(${match.id}, 'race', ${participant.odds}, '${participant.number}ë²ˆ ${participant.name}', ${participant.number})" 
                                            class="odds-btn text-center">
                                        <div class="text-xs text-gray-600">${participant.number}ë²ˆ</div>
                                        <div class="text-sm font-medium truncate">${participant.name}</div>
                                        <div class="text-lg font-bold text-blue-600">${participant.odds}ë°°</div>
                                    </button>
                                `).join('')}
                            </div>
                            
                            <div class="bg-gray-200 rounded-full h-2 overflow-hidden">
                                <div class="progress-bar h-full" style="width: ${(remaining / 180) * 100}%"></div>
                            </div>
                        </div>
                    `;
                } else {
                    // ì¼ë°˜ ìŠ¤í¬ì¸  ë ˆì´ì•„ì›ƒ
                    return `
                        <div class="card p-6 mb-4">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center gap-3">
                                    <span class="sport-icon">${getSportIcon(match.sport)}</span>
                                    <div>
                                        <div class="text-gray-900 font-bold">${match.sport}</div>
                                        <div class="text-red-600 text-sm flex items-center gap-1">
                                            <span class="live-indicator">â—</span> LIVE
                                        </div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-gray-900 font-bold text-xl">${match.score1} : ${match.score2}</div>
                                    <div class="text-blue-600 font-medium">${minutes}:${seconds.toString().padStart(2, '0')}</div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-${match.oddsDraw ? '3' : '2'} gap-3 mb-4">
                                <button onclick="placeBet(${match.id}, 'team1', ${match.odds1}, '${match.team1}')" 
                                        class="odds-btn text-center py-4">
                                    <div class="text-sm font-medium">${match.team1}</div>
                                    <div class="text-xl font-bold text-blue-600">${match.odds1}</div>
                                </button>
                                
                                ${match.oddsDraw ? `
                                    <button onclick="placeBet(${match.id}, 'draw', ${match.oddsDraw}, 'ë¬´ìŠ¹ë¶€')" 
                                            class="odds-btn text-center py-4">
                                        <div class="text-sm font-medium">ë¬´ìŠ¹ë¶€</div>
                                        <div class="text-xl font-bold text-blue-600">${match.oddsDraw}</div>
                                    </button>
                                ` : ''}
                                
                                <button onclick="placeBet(${match.id}, 'team2', ${match.odds2}, '${match.team2}')" 
                                        class="odds-btn text-center py-4">
                                    <div class="text-sm font-medium">${match.team2}</div>
                                    <div class="text-xl font-bold text-blue-600">${match.odds2}</div>
                                </button>
                            </div>
                            
                            <div class="bg-gray-200 rounded-full h-2 overflow-hidden">
                                <div class="progress-bar h-full" style="width: ${(remaining / 180) * 100}%"></div>
                            </div>
                        </div>
                    `;
                }
            }).join('');
        }

        // ì˜ˆì • ê²½ê¸° ì—…ë°ì´íŠ¸
        function updateUpcomingMatches() {
            const container = document.getElementById('upcomingMatches');
            
            container.innerHTML = upcomingMatches.map(match => {
                const timeUntil = Math.max(0, match.startTime - Date.now());
                const minutes = Math.floor(timeUntil / 60000);
                const seconds = Math.floor((timeUntil % 60000) / 1000);
                
                if (match.isRace) {
                    // ê²½ë§ˆ/ê°œê²½ê¸° ì˜ˆì • ê²½ê¸°
                    return `
                        <div class="match-card rounded-lg p-4">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="text-xl">${getSportIcon(match.sport)}</span>
                                <div>
                                    <div class="text-white font-medium">${match.sport} - ${match.raceDistance}</div>
                                    <div class="text-blue-400 text-sm">${minutes}:${seconds.toString().padStart(2, '0')} í›„ ì‹œì‘</div>
                                </div>
                            </div>
                            
                            <div class="text-center mb-3">
                                <div class="text-white font-bold">${match.participants.length}ë§ˆë¦¬ ì¶œì „</div>
                                <div class="text-slate-400 text-sm">ë ˆì´ìŠ¤ ì˜ˆì •</div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-1 text-center text-xs">
                                ${match.participants.slice(0, 4).map(participant => `
                                    <div class="bg-slate-700 py-1 rounded">
                                        <div class="text-slate-300">${participant.number}ë²ˆ ${participant.name}</div>
                                        <div class="text-green-400 font-bold">${participant.odds}ë°°</div>
                                    </div>
                                `).join('')}
                            </div>
                            ${match.participants.length > 4 ? `
                                <div class="text-center text-slate-400 text-xs mt-2">
                                    ì™¸ ${match.participants.length - 4}ë§ˆë¦¬ ë”...
                                </div>
                            ` : ''}
                        </div>
                    `;
                } else {
                    // ì¼ë°˜ ìŠ¤í¬ì¸  ì˜ˆì • ê²½ê¸°
                    return `
                        <div class="match-card rounded-lg p-4">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="text-xl">${getSportIcon(match.sport)}</span>
                                <div>
                                    <div class="text-white font-medium">${match.sport}</div>
                                    <div class="text-blue-400 text-sm">${minutes}:${seconds.toString().padStart(2, '0')} í›„ ì‹œì‘</div>
                                </div>
                            </div>
                            
                            <div class="text-center mb-3">
                                <div class="text-white">${match.team1}</div>
                                <div class="text-slate-400 text-sm">vs</div>
                                <div class="text-white">${match.team2}</div>
                            </div>
                            
                            <div class="grid grid-cols-${match.oddsDraw ? '3' : '2'} gap-2 text-center text-sm">
                                <div class="bg-slate-700 py-2 rounded">
                                    <div class="text-slate-300">${match.team1}</div>
                                    <div class="text-green-400 font-bold">${match.odds1}</div>
                                </div>
                                ${match.oddsDraw ? `
                                    <div class="bg-slate-700 py-2 rounded">
                                        <div class="text-slate-300">ë¬´ìŠ¹ë¶€</div>
                                        <div class="text-green-400 font-bold">${match.oddsDraw}</div>
                                    </div>
                                ` : ''}
                                <div class="bg-slate-700 py-2 rounded">
                                    <div class="text-slate-300">${match.team2}</div>
                                    <div class="text-green-400 font-bold">${match.odds2}</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }).join('');
        }

        // ë² íŒ… ë‚´ì—­ ì—…ë°ì´íŠ¸
        function updateBettingHistory() {
            const tbody = document.getElementById('bettingHistory');
            
            // í˜„ì¬ ë² íŒ…ê³¼ ì™„ë£Œëœ ë² íŒ…ì„ ëª¨ë‘ í¬í•¨
            const allBets = [...bettingHistory, ...currentBets.map(bet => ({
                ...bet,
                result: 'pending',
                timestamp: bet.timestamp
            }))];
            
            if (allBets.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="text-center text-slate-400 py-8">
                            <div class="text-4xl mb-2">ğŸ“Š</div>
                            <p>ì•„ì§ ë² íŒ… ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // ì‹œê°„ìˆœìœ¼ë¡œ ì •ë ¬ (ìµœì‹ ìˆœ)
            allBets.sort((a, b) => b.timestamp - a.timestamp);
            
            tbody.innerHTML = allBets.slice(0, 20).map(bet => {
                const date = new Date(bet.timestamp).toLocaleDateString();
                const time = new Date(bet.timestamp).toLocaleTimeString();
                
                let resultClass, resultText, points;
                
                if (bet.result === 'pending') {
                    resultClass = 'text-yellow-400';
                    resultText = 'ì§„í–‰ì¤‘';
                    points = `${bet.amount}P ë² íŒ…`;
                } else if (bet.result === 'win') {
                    resultClass = 'text-green-400';
                    resultText = 'ìŠ¹ë¦¬';
                    points = `+${Math.floor(bet.amount * bet.odds)}P`;
                } else {
                    resultClass = 'text-red-400';
                    resultText = 'íŒ¨ë°°';
                    points = `-${bet.amount}P`;
                }
                
                let matchDisplay;
                if (bet.isRace) {
                    matchDisplay = `${bet.match.sport} - ${bet.match.raceDistance || 'ë ˆì´ìŠ¤'}`;
                } else {
                    matchDisplay = `${bet.match.team1} vs ${bet.match.team2}`;
                }
                
                return `
                    <tr class="hover:bg-slate-700">
                        <td class="px-4 py-3 text-white">
                            ${matchDisplay}
                            <div class="text-sm text-slate-400">${date} ${time}</div>
                        </td>
                        <td class="px-4 py-3 text-slate-300">${bet.teamName}</td>
                        <td class="px-4 py-3 text-slate-300">${bet.odds}ë°°</td>
                        <td class="px-4 py-3 text-slate-300">${bet.amount}P</td>
                        <td class="px-4 py-3">
                            <span class="${resultClass} font-medium">${resultText}</span>
                            <div class="text-sm ${resultClass}">${points}</div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ë­í‚¹ ìƒì„±
        function generateInitialRankings() {
            const names = ['ë² íŒ…í‚¹', 'ëŸ­í‚¤ì„¸ë¸', 'ê³¨ë“ í„°ì¹˜', 'ìŠ¤í¬ì¸ ë§¤ë‹ˆì•„', 'ìŠ¹ë¶€ì‚¬', 'í¬ì¸íŠ¸í—Œí„°', 'ë² íŒ…ë§ˆìŠ¤í„°', 'ëŸ­í‚¤ìŠ¤íƒ€'];
            
            rankings = names.map((name, index) => ({
                name: name,
                points: 15000 - (index * 1000) + Math.floor(Math.random() * 500),
                wins: Math.floor(Math.random() * 50) + 20,
                totalBets: Math.floor(Math.random() * 100) + 50
            }));
            
            // í˜„ì¬ ì‚¬ìš©ì ì¶”ê°€
            rankings.push({
                name: 'ë‚˜',
                points: userPoints,
                wins: bettingHistory.filter(bet => bet.result === 'win').length,
                totalBets: bettingHistory.length,
                isUser: true
            });
            
            updateRankings();
        }

        // ë­í‚¹ ì—…ë°ì´íŠ¸
        function updateRankings() {
            // ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
            const userRank = rankings.find(r => r.isUser);
            if (userRank) {
                userRank.points = userPoints;
                userRank.wins = bettingHistory.filter(bet => bet.result === 'win').length;
                userRank.totalBets = bettingHistory.length;
            }
            
            // í¬ì¸íŠ¸ ìˆœìœ¼ë¡œ ì •ë ¬
            rankings.sort((a, b) => b.points - a.points);
            
            // ìˆœìœ„ ì—…ë°ì´íŠ¸
            rankings.forEach((rank, index) => {
                rank.position = index + 1;
            });
            
            updateTopRankings();
            
            // ì‚¬ìš©ì ìˆœìœ„ í‘œì‹œ
            const userPosition = rankings.find(r => r.isUser)?.position || 1;
            document.getElementById('userRank').textContent = `#${userPosition}`;
        }

        // TOP 5 ë­í‚¹ ì—…ë°ì´íŠ¸
        function updateTopRankings() {
            const container = document.getElementById('topRankings');
            
            container.innerHTML = rankings.slice(0, 5).map(rank => {
                const medalClass = rank.position === 1 ? 'rank-gold' : 
                                 rank.position === 2 ? 'rank-silver' : 
                                 rank.position === 3 ? 'rank-bronze' : 'text-slate-300';
                
                const medal = rank.position === 1 ? 'ğŸ¥‡' : 
                             rank.position === 2 ? 'ğŸ¥ˆ' : 
                             rank.position === 3 ? 'ğŸ¥‰' : `#${rank.position}`;
                
                return `
                    <div class="flex items-center justify-between p-3 bg-slate-700 rounded-lg ${rank.isUser ? 'ring-2 ring-blue-500' : ''}">
                        <div class="flex items-center gap-3">
                            <span class="${medalClass} font-bold">${medal}</span>
                            <div>
                                <div class="text-white font-medium">${rank.name}</div>
                                <div class="text-slate-400 text-sm">${rank.wins}ìŠ¹ / ${rank.totalBets}ì „</div>
                            </div>
                        </div>
                        <div class="text-yellow-400 font-bold">${rank.points.toLocaleString()}P</div>
                    </div>
                `;
            }).join('');
        }

        // ì „ì²´ ë­í‚¹ í‘œì‹œ
        function showRankings() {
            const modal = document.getElementById('rankingModal');
            const container = document.getElementById('fullRankings');
            
            container.innerHTML = rankings.map(rank => {
                const medalClass = rank.position === 1 ? 'rank-gold' : 
                                 rank.position === 2 ? 'rank-silver' : 
                                 rank.position === 3 ? 'rank-bronze' : 'text-slate-300';
                
                const medal = rank.position === 1 ? 'ğŸ¥‡' : 
                             rank.position === 2 ? 'ğŸ¥ˆ' : 
                             rank.position === 3 ? 'ğŸ¥‰' : `#${rank.position}`;
                
                const winRate = rank.totalBets > 0 ? ((rank.wins / rank.totalBets) * 100).toFixed(1) : '0.0';
                
                return `
                    <div class="flex items-center justify-between p-4 bg-slate-700 rounded-lg ${rank.isUser ? 'ring-2 ring-blue-500' : ''}">
                        <div class="flex items-center gap-4">
                            <span class="${medalClass} font-bold text-lg">${medal}</span>
                            <div>
                                <div class="text-white font-medium">${rank.name}</div>
                                <div class="text-slate-400 text-sm">
                                    ${rank.wins}ìŠ¹ ${rank.totalBets - rank.wins}íŒ¨ (ìŠ¹ë¥  ${winRate}%)
                                </div>
                            </div>
                        </div>
                        <div class="text-yellow-400 font-bold text-lg">${rank.points.toLocaleString()}P</div>
                    </div>
                `;
            }).join('');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // ë­í‚¹ ëª¨ë‹¬ ìˆ¨ê¸°ê¸°
        function hideRankings() {
            document.getElementById('rankingModal').classList.add('hidden');
            document.getElementById('rankingModal').classList.remove('flex');
        }

        // ê´€ë¦¬ì íŒ¨ë„ í‘œì‹œ
        function showAdminPanel() {
            updateAdminStats();
            document.getElementById('adminModal').classList.remove('hidden');
            document.getElementById('adminModal').classList.add('flex');
        }

        // ê´€ë¦¬ì íŒ¨ë„ ìˆ¨ê¸°ê¸°
        function hideAdminPanel() {
            document.getElementById('adminModal').classList.add('hidden');
            document.getElementById('adminModal').classList.remove('flex');
        }

        // ê´€ë¦¬ì í†µê³„ ì—…ë°ì´íŠ¸
        function updateAdminStats() {
            document.getElementById('adminLiveCount').textContent = liveMatches.length;
            document.getElementById('adminUpcomingCount').textContent = upcomingMatches.length;
            document.getElementById('adminBetCount').textContent = currentBets.length;
        }

        // í¬ì¸íŠ¸ ì¶”ê°€
        function addPoints() {
            const amount = parseInt(document.getElementById('pointsToAdd').value);
            if (isNaN(amount) || amount <= 0) {
                alert('ì˜¬ë°”ë¥¸ í¬ì¸íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            userPoints += amount;
            updateUI();
            saveUserData();
            
            // ì„±ê³µ ì• ë‹ˆë©”ì´ì…˜
            showWinAnimation(amount);
            
            alert(`âœ… ${amount.toLocaleString()}Pê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!\ní˜„ì¬ í¬ì¸íŠ¸: ${userPoints.toLocaleString()}P`);
            document.getElementById('pointsToAdd').value = '';
        }

        // í¬ì¸íŠ¸ ì°¨ê°
        function removePoints() {
            const amount = parseInt(document.getElementById('pointsToAdd').value);
            if (isNaN(amount) || amount <= 0) {
                alert('ì˜¬ë°”ë¥¸ í¬ì¸íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (amount > userPoints) {
                alert('ì°¨ê°í•  í¬ì¸íŠ¸ê°€ í˜„ì¬ í¬ì¸íŠ¸ë³´ë‹¤ ë§ìŠµë‹ˆë‹¤.');
                return;
            }
            
            userPoints -= amount;
            updateUI();
            saveUserData();
            
            alert(`âœ… ${amount.toLocaleString()}Pê°€ ì°¨ê°ë˜ì—ˆìŠµë‹ˆë‹¤!\ní˜„ì¬ í¬ì¸íŠ¸: ${userPoints.toLocaleString()}P`);
            document.getElementById('pointsToAdd').value = '';
        }

        // í¬ì¸íŠ¸ ì„¤ì •
        function setPoints(amount) {
            userPoints = amount;
            updateUI();
            saveUserData();
            
            alert(`âœ… í¬ì¸íŠ¸ê°€ ${amount.toLocaleString()}Pë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        // í¬ì¸íŠ¸ ì´ˆê¸°í™”
        function resetPoints() {
            if (confirm('ì •ë§ë¡œ í¬ì¸íŠ¸ë¥¼ 10,000Pë¡œ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                userPoints = 10000;
                updateUI();
                saveUserData();
                alert('âœ… í¬ì¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
        }

        // ê°•ì œ ê²½ê¸° ìƒì„±
        function forceCreateMatch() {
            const newMatch = createRandomMatch(true);
            liveMatches.push(newMatch);
            updateLiveMatches();
            updateAdminStats();
            
            alert(`âœ… ìƒˆë¡œìš´ ${newMatch.sport} ê²½ê¸°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        // ëª¨ë“  ê²½ê¸° ì¢…ë£Œ
        function endAllMatches() {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ì§„í–‰ ì¤‘ì¸ ê²½ê¸°ë¥¼ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // ê° ê²½ê¸°ì— ëŒ€í•´ ëœë¤ ê²°ê³¼ ìƒì„±
                liveMatches.forEach(match => {
                    let winner;
                    if (match.isRace) {
                        winner = Math.floor(Math.random() * match.participants.length) + 1;
                    } else {
                        const result = Math.random();
                        if (result < 0.4) winner = 'team1';
                        else if (result < 0.8) winner = 'team2';
                        else winner = 'draw';
                    }
                    processBettingResults(match.id, winner);
                });
                
                liveMatches = [];
                updateLiveMatches();
                updateAdminStats();
                
                alert('âœ… ëª¨ë“  ê²½ê¸°ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
        }

        // íŠ¹ë³„ ì´ë²¤íŠ¸ ê²½ê¸° ìƒì„±
        function createSpecialEvent() {
            const specialMatch = {
                id: Date.now() + Math.random(),
                sport: 'íŠ¹ë³„ ì´ë²¤íŠ¸',
                team1: 'ğŸŒŸ ê³¨ë“ íŒ€',
                team2: 'ğŸ’ ë‹¤ì´ì•„ëª¬ë“œíŒ€',
                odds1: '5.00',
                odds2: '5.00',
                oddsDraw: '10.00',
                isLive: true,
                startTime: Date.now(),
                duration: 300000, // 5ë¶„
                score1: 0,
                score2: 0,
                isSpecial: true
            };
            
            liveMatches.push(specialMatch);
            updateLiveMatches();
            updateAdminStats();
            
            alert('âœ¨ íŠ¹ë³„ ì´ë²¤íŠ¸ ê²½ê¸°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\në†’ì€ ë°°ë‹¹ë¥ ë¡œ í° ìˆ˜ìµì„ ë…¸ë ¤ë³´ì„¸ìš”!');
        }

        // ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
        function resetAllData() {
            if (confirm('âš ï¸ ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                if (confirm('ë§ˆì§€ë§‰ í™•ì¸: ë² íŒ… ë‚´ì—­, í¬ì¸íŠ¸, ë­í‚¹ì´ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤.')) {
                    localStorage.removeItem('virtSportsData');
                    userPoints = 10000;
                    bettingHistory = [];
                    currentBets = [];
                    liveMatches = [];
                    upcomingMatches = [];
                    rankings = [];
                    
                    // ë‹¤ì‹œ ì´ˆê¸°í™”
                    init();
                    
                    alert('âœ… ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }
            }
        }

        // ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        function exportData() {
            const data = {
                userPoints: userPoints,
                bettingHistory: bettingHistory,
                rankings: rankings,
                currentBets: currentBets,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `virtsports_backup_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            
            alert('âœ… ë°ì´í„°ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ìŠ¤í¬ì¸  ì•„ì´ì½˜ ê°€ì ¸ì˜¤ê¸°
        function getSportIcon(sport) {
            const icons = {
                'ì¶•êµ¬': 'âš½',
                'ë†êµ¬': 'ğŸ€',
                'ì•¼êµ¬': 'âš¾',
                'í…Œë‹ˆìŠ¤': 'ğŸ¾',
                'ë°°êµ¬': 'ğŸ',
                'ë§ê²½ê¸°': 'ğŸ',
                'ê°œê²½ê¸°': 'ğŸ•'
            };
            return icons[sport] || 'ğŸ†';
        }

        // ì˜ˆì • ê²½ê¸°ë¥¼ ë¼ì´ë¸Œë¡œ ì´ë™
        function moveUpcomingToLive() {
            const now = Date.now();
            const readyMatches = upcomingMatches.filter(match => match.startTime <= now);
            
            readyMatches.forEach(match => {
                match.isLive = true;
                match.startTime = now;
                liveMatches.push(match);
            });
            
            upcomingMatches = upcomingMatches.filter(match => match.startTime > now);
        }

        // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
        function updateMatchTimers() {
            moveUpcomingToLive();
            updateLiveMatches();
            updateUpcomingMatches();
        }

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            document.getElementById('userPoints').textContent = userPoints.toLocaleString();
            updateTopRankings();
        }

        // ì¦‰ì‹œ ê²½ê¸° ìƒì„± ë° í‘œì‹œ
        function initializeMatches() {
            console.log('ê²½ê¸° ì´ˆê¸°í™” ì‹œì‘');
            
            // ë¼ì´ë¸Œ ê²½ê¸° ê°•ì œ ìƒì„±
            liveMatches = [
                {
                    id: 1001,
                    sport: 'ì¶•êµ¬',
                    team1: 'ë ˆì•Œ ë§ˆë“œë¦¬ë“œ',
                    team2: 'ë°”ë¥´ì…€ë¡œë‚˜',
                    odds1: '2.10',
                    odds2: '1.85',
                    oddsDraw: '3.20',
                    isLive: true,
                    startTime: Date.now(),
                    duration: 180000,
                    score1: 1,
                    score2: 0
                },
                {
                    id: 1002,
                    sport: 'ë†êµ¬',
                    team1: 'ë ˆì´ì»¤ìŠ¤',
                    team2: 'ì›Œë¦¬ì–´ìŠ¤',
                    odds1: '1.95',
                    odds2: '1.90',
                    oddsDraw: null,
                    isLive: true,
                    startTime: Date.now(),
                    duration: 180000,
                    score1: 78,
                    score2: 82
                },
                {
                    id: 1003,
                    sport: 'ë§ê²½ê¸°',
                    isRace: true,
                    participants: [
                        { name: 'ì¬ë”ë³¼íŠ¸', number: 1, odds: '2.50', position: 85 },
                        { name: 'ê³¨ë“ ìŠ¤í”¼ë“œ', number: 2, odds: '3.20', position: 78 },
                        { name: 'ë¡œì—´í”„ë¦°ìŠ¤', number: 3, odds: '4.10', position: 72 },
                        { name: 'íŒŒì´ì–´ìŠ¤í†°', number: 4, odds: '5.50', position: 68 },
                        { name: 'ìœˆë“œëŸ¬ë„ˆ', number: 5, odds: '6.80', position: 65 },
                        { name: 'ë¸”ë™ë‹¤ì´ì•„ëª¬ë“œ', number: 6, odds: '8.20', position: 60 }
                    ],
                    isLive: true,
                    startTime: Date.now(),
                    duration: 180000,
                    raceDistance: '1200m'
                }
            ];
            
            console.log('ìƒì„±ëœ ê²½ê¸° ìˆ˜:', liveMatches.length);
            
            // ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸
            updateLiveMatches();
            generateUpcomingMatches();
            updateUpcomingMatches();
            generateRankings();
            updateUI();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('í˜ì´ì§€ ë¡œë“œë¨');
            loadUserData();
            showSection('live');
            initializeMatches();
            
            // íƒ€ì´ë¨¸ ì‹œì‘
            setInterval(processMatchResults, 180000);
            setInterval(generateNewMatch, 30000);
            setInterval(updateMatchTimers, 1000);
        });

        // í˜ì´ì§€ê°€ ì™„ì „íˆ ë¡œë“œë˜ì§€ ì•Šì•˜ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ ë°±ì—…
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeMatches);
        } else {
            // ì´ë¯¸ ë¡œë“œëœ ê²½ìš° ì¦‰ì‹œ ì‹¤í–‰
            setTimeout(function() {
                loadUserData();
                showSection('live');
                initializeMatches();
            }, 50);
        }

        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ë°ì´í„° ì €ì¥
        window.onbeforeunload = function() {
            saveUserData();
        };
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9711d2fc3292aa4a',t:'MTc1NTUyNDQzOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
